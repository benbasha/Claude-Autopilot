<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#007acc">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Claude Remote">
    <title>Claude Autopilot Remote</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <div class="mobile-app">
        <!-- Header -->
        <header class="mobile-header">
            <div class="header-content">
                <div class="app-title-section">
                    <h1 class="app-title">
                        <span class="app-icon">ü§ñ</span>
                        Claude Autopilot Remote
                        <span class="version">Mobile</span>
                    </h1>
                    <div class="workspace-info">
                        <span class="workspace-label">üìÅ</span>
                        <span id="workspace-name" class="workspace-name">Loading...</span>
                    </div>
                </div>
                <div class="status-indicators">
                    <div class="connection-status" id="connection-status" data-status="disconnected">
                        <span class="status-dot"></span>
                        <span class="status-text">Disconnected</span>
                    </div>
                    <div class="session-status" id="session-status" data-status="idle">
                        <span class="session-icon">‚è∏Ô∏è</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="mobile-main">
            <!-- Quick Actions -->
            <section class="quick-actions">
                <button class="action-btn action-btn--start" id="start-btn" data-action="start">
                    <span class="btn-icon">‚ñ∂Ô∏è</span>
                    <span class="btn-text">Start</span>
                    <span class="btn-subtitle">Begin processing</span>
                </button>
                
                <button class="action-btn action-btn--stop" id="stop-btn" data-action="stop">
                    <span class="btn-icon">‚èπÔ∏è</span>
                    <span class="btn-text">Stop</span>
                    <span class="btn-subtitle">Pause queue</span>
                </button>
                
                <button class="action-btn action-btn--interrupt" id="interrupt-btn" data-action="interrupt">
                    <span class="btn-icon">‚ö†Ô∏è</span>
                    <span class="btn-text">Interrupt</span>
                    <span class="btn-subtitle">Send ESC key</span>
                </button>
                
                <button class="action-btn action-btn--reset" id="reset-btn" data-action="reset">
                    <span class="btn-icon">üîÑ</span>
                    <span class="btn-text">Reset</span>
                    <span class="btn-subtitle">Clear session</span>
                </button>
            </section>

            <!-- Queue Section -->
            <section class="queue-section">
                <header class="section-header">
                    <h2 class="section-title">
                        Message Queue
                        <span class="queue-counter" id="queue-counter" data-count="0">0</span>
                    </h2>
                    <button class="section-toggle" id="queue-toggle" data-expanded="true">
                        <span class="toggle-icon">‚ñº</span>
                    </button>
                </header>
                
                <div class="section-content" id="queue-content">
                    <button class="add-message-btn" id="add-message-btn">
                        <span class="btn-icon">‚ûï</span>
                        Add Message
                    </button>
                    
                    <div class="queue-container" id="queue-container">
                        <!-- Queue items will be populated by JavaScript -->
                    </div>
                </div>
            </section>

            <!-- Output Section -->
            <section class="output-section">
                <header class="section-header">
                    <h2 class="section-title">Live Output</h2>
                    <div class="output-controls">
                        <button class="control-btn" id="clear-output-btn" data-action="clear">Clear</button>
                        <button class="control-btn" id="scroll-lock-btn" data-action="scroll-lock">üìå</button>
                    </div>
                </header>
                
                <div class="section-content" id="output-content">
                    <div class="output-container">
                        <div class="output-stream" id="claude-output">
                            <div class="output-line" data-type="system">
                                <span class="line-prefix">‚öôÔ∏è</span>
                                <span class="line-content">Waiting for connection...</span>
                                <span class="line-time" id="current-time"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- File Explorer Section -->
            <section class="file-explorer-section">
                <header class="section-header">
                    <h2 class="section-title">
                        File Explorer
                        <span class="file-counter" id="file-counter" data-count="0">0 files</span>
                    </h2>
                    <div class="explorer-controls">
                        <button class="control-btn" id="refresh-files" data-action="refresh" title="Refresh file tree">üîÑ</button>
                        <button class="control-btn" id="search-files" data-action="search" title="Search in files">üîç</button>
                    </div>
                    <button class="section-toggle" id="explorer-toggle" data-expanded="false">
                        <span class="toggle-icon">‚ñ∂</span>
                    </button>
                </header>
                
                <div class="section-content" id="explorer-content" style="display: none;">
                    <div class="file-tree-container">
                        <div class="file-tree-loading" id="file-tree-loading" style="display: none;">
                            <div class="loading-spinner"></div>
                            <span class="loading-text">Loading files...</span>
                        </div>
                        <div class="file-tree" id="file-tree">
                            <!-- File tree items populated by JavaScript -->
                        </div>
                        <div class="file-tree-empty" id="file-tree-empty" style="display: none;">
                            <span class="empty-icon">üìÇ</span>
                            <span class="empty-text">No files found</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Git Changes Section -->
            <section class="git-changes-section" role="region" aria-labelledby="git-changes-heading">
                <header class="section-header">
                    <h2 class="section-title" id="git-changes-heading">
                        Git Changes
                        <span class="file-counter" id="git-file-counter" data-count="0" aria-label="Number of changed files">0 files</span>
                    </h2>
                    <div class="git-controls" role="toolbar" aria-label="Git operations">
                        <button class="control-btn" id="refresh-git" data-action="refresh" title="Refresh git status" aria-label="Refresh git status">üîÑ</button>
                        <button class="control-btn" id="git-branch-info" data-action="branch" title="Branch information" aria-label="Show branch information">üåø</button>
                        <button class="control-btn" id="git-search-toggle" data-action="search" title="Search and filter files" aria-label="Search and filter files">üîç</button>
                        <button class="control-btn" id="git-help-btn" data-action="help" title="Show keyboard shortcuts" aria-label="Show keyboard shortcuts help">‚ùì</button>
                        <button class="control-btn" id="git-performance-btn" data-action="performance" title="Show performance metrics" aria-label="Show performance metrics dashboard">‚ö°</button>
                        <button class="control-btn" id="stage-all-btn" data-action="stage-all" title="Stage all files" aria-label="Stage all changed files">üì•</button>
                        <button class="control-btn" id="unstage-all-btn" data-action="unstage-all" title="Unstage all files" aria-label="Unstage all staged files">üì§</button>
                    </div>
                    <button class="section-toggle" id="git-toggle" data-expanded="false" aria-label="Toggle git changes section" aria-expanded="false" aria-controls="git-content">
                        <span class="toggle-icon">‚ñ∂</span>
                    </button>
                </header>
                
                <div class="section-content" id="git-content" style="display: none;">
                    <!-- Branch Info -->
                    <div class="branch-info" id="branch-info">
                        <div class="branch-details">
                            <span class="branch-name" id="branch-name">main</span>
                            <span class="branch-status" id="branch-status">up to date</span>
                        </div>
                        <div class="commit-info" id="commit-info">
                            <span class="commit-hash" id="commit-hash">#abc123</span>
                            <span class="commit-message" id="commit-message">Initial commit</span>
                        </div>
                    </div>

                    <!-- Performance Dashboard -->
                    <div class="performance-dashboard" id="performance-dashboard">
                        <div class="performance-title">
                            ‚ö° Performance Metrics
                            <span class="performance-indicator" id="performance-indicator">
                                <span id="performance-status">Normal</span>
                            </span>
                        </div>
                        <div class="performance-metrics" id="performance-metrics">
                            <!-- Metrics populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Git Search and Filter -->
                    <div class="git-search-container" id="git-search-container" style="display: none;" role="search" aria-label="Git file search and filter">
                        <div class="search-input-group">
                            <input type="text" id="git-search-input" placeholder="Search files... (use content:term for content search, regex patterns supported)" class="git-search-input" aria-label="Search git files" aria-describedby="search-help">
                            <button class="search-clear-btn" id="git-search-clear" title="Clear search" aria-label="Clear search">√ó</button>
                        </div>
                        <div class="filter-controls" role="radiogroup" aria-label="Filter files by status">
                            <button class="filter-btn" id="filter-all" data-status="all" role="radio" aria-checked="true">All</button>
                            <button class="filter-btn" id="filter-modified" data-status="modified" role="radio" aria-checked="false">Modified</button>
                            <button class="filter-btn" id="filter-added" data-status="added" role="radio" aria-checked="false">Added</button>
                            <button class="filter-btn" id="filter-deleted" data-status="deleted" role="radio" aria-checked="false">Deleted</button>
                            <button class="filter-btn" id="filter-staged" data-status="staged" role="radio" aria-checked="false">Staged</button>
                        </div>
                        <div id="search-help" class="sr-only">Search supports regex patterns and content search with content:keyword syntax</div>
                    </div>

                    <!-- Git Status Container -->
                    <div class="git-status-container" aria-live="polite" aria-label="Git file changes">
                        <div class="git-loading" id="git-loading" style="display: none;" role="status" aria-label="Loading git status">
                            <div class="loading-spinner"></div>
                            <span class="loading-text">Loading git status...</span>
                        </div>
                        <div class="git-files" id="git-files" role="list" aria-label="Changed files">
                            <!-- Git file items populated by JavaScript -->
                        </div>
                        <div class="git-clean" id="git-clean" style="display: none;" role="status" aria-label="Working tree is clean">
                            <span class="clean-icon">‚úÖ</span>
                            <span class="clean-text">Working tree clean</span>
                        </div>
                        <div class="git-no-results" id="git-no-results" style="display: none;" role="status" aria-label="No search results">
                            <span class="no-results-icon">üîç</span>
                            <span class="no-results-text">No files match your search</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Status Bar -->
        <footer class="status-bar">
            <span class="status-item" id="connection-indicator">
                <span class="status-dot"></span>
                <span class="status-text">Connecting...</span>
            </span>
            <span class="status-item" id="message-count">
                Messages: <span id="total-messages">0</span>
            </span>
        </footer>
    </div>

    <!-- Add Message Modal -->
    <div class="modal" id="add-message-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Message</h3>
                <button class="modal-close" id="close-add-modal">&times;</button>
            </div>
            <div class="modal-body">
                <textarea 
                    id="message-input" 
                    placeholder="Enter your message for Claude..."
                    rows="4"
                ></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" id="cancel-add-message">Cancel</button>
                <button class="btn btn--primary" id="confirm-add-message">Add Message</button>
            </div>
        </div>
    </div>

    <!-- Edit Message Modal -->
    <div class="modal" id="edit-message-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Message</h3>
                <button class="modal-close" id="close-edit-modal">&times;</button>
            </div>
            <div class="modal-body">
                <textarea 
                    id="edit-message-input" 
                    placeholder="Edit your message..."
                    rows="4"
                ></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" id="cancel-edit-message">Cancel</button>
                <button class="btn btn--primary" id="confirm-edit-message">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- File Preview Modal -->
    <div class="modal file-preview-modal" id="file-preview-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4 id="preview-file-name">Loading...</h4>
                <div class="preview-controls">
                    <button class="control-btn" id="copy-file-path" title="Copy file path">üìã</button>
                    <button class="modal-close" id="close-preview">&times;</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="preview-content-container">
                    <div class="preview-loading" id="preview-loading" style="display: none;">
                        <div class="loading-spinner"></div>
                        <span class="loading-text">Loading file content...</span>
                    </div>
                    <div class="preview-content" id="preview-content">
                        <pre><code id="preview-code-content" class="language-text"></code></pre>
                    </div>
                    <div class="preview-error" id="preview-error" style="display: none;">
                        <span class="error-icon">‚ö†Ô∏è</span>
                        <span class="error-text">Failed to load file content</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="file-info">
                    <span class="file-size" id="preview-file-size">0 KB</span>
                    <span class="file-separator">‚Ä¢</span>
                    <span class="file-lines" id="preview-file-lines">0 lines</span>
                    <span class="file-separator">‚Ä¢</span>
                    <span class="file-modified" id="preview-file-modified">Modified: --</span>
                </div>
            </div>
        </div>
    </div>

    <!-- File Search Modal -->
    <div class="modal file-search-modal" id="file-search-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Search Files</h3>
                <button class="modal-close" id="close-search">&times;</button>
            </div>
            <div class="modal-body">
                <div class="search-form">
                    <input type="text" id="search-input" placeholder="Search in files..." autocomplete="off">
                    <div class="search-filters">
                        <select id="search-extensions">
                            <option value="">All files</option>
                            <option value=".ts,.js,.tsx,.jsx">TypeScript/JavaScript</option>
                            <option value=".py">Python</option>
                            <option value=".md">Markdown</option>
                            <option value=".json">JSON</option>
                            <option value=".css,.scss,.sass">Stylesheets</option>
                            <option value=".html,.htm">HTML</option>
                            <option value=".txt,.log">Text/Logs</option>
                        </select>
                        <button class="btn btn--primary" id="perform-search">Search</button>
                    </div>
                </div>
                <div class="search-results-container">
                    <div class="search-loading" id="search-loading" style="display: none;">
                        <div class="loading-spinner"></div>
                        <span class="loading-text">Searching...</span>
                    </div>
                    <div class="search-results" id="search-results">
                        <!-- Search results populated by JavaScript -->
                    </div>
                    <div class="search-empty" id="search-empty" style="display: none;">
                        <span class="empty-icon">üîç</span>
                        <span class="empty-text">No results found</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Diff Viewer Modal -->
    <div class="modal diff-viewer-modal" id="diff-viewer-modal">
        <div class="modal-content modal-content--large">
            <div class="modal-header">
                <h4 id="diff-file-name">Git Diff</h4>
                <div class="diff-controls">
                    <select id="diff-compare-mode" class="compare-select">
                        <option value="working">Working vs Staged</option>
                        <option value="staged">Staged vs HEAD</option>
                        <option value="head">Working vs HEAD</option>
                        <option value="main">Working vs Main</option>
                    </select>
                    <button class="control-btn" id="copy-diff" title="Copy diff">üìã</button>
                    <button class="modal-close" id="close-diff">&times;</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="diff-content-container">
                    <div class="diff-loading" id="diff-loading" style="display: none;">
                        <div class="loading-spinner"></div>
                        <span class="loading-text">Loading diff...</span>
                    </div>
                    
                    <!-- Diff Stats -->
                    <div class="diff-stats" id="diff-stats">
                        <span class="stat-item additions" id="diff-additions">+0</span>
                        <span class="stat-item deletions" id="diff-deletions">-0</span>
                        <span class="stat-item file-type" id="diff-file-type">text</span>
                    </div>
                    
                    <!-- Diff Content -->
                    <div class="diff-content" id="diff-content">
                        <div class="diff-lines" id="diff-lines">
                            <!-- Diff lines populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="diff-error" id="diff-error" style="display: none;">
                        <span class="error-icon">‚ö†Ô∏è</span>
                        <span class="error-text">Failed to load diff</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="diff-info">
                    <span class="file-path" id="diff-file-path">--</span>
                </div>
                <div class="diff-actions">
                    <button class="btn btn--secondary" id="view-file-btn">View File</button>
                    <button class="btn btn--primary" id="add-to-queue-btn">Add to Queue</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Git Action Confirmation Modal -->
    <div class="modal git-confirm-modal" id="git-confirm-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4 id="git-confirm-title">Confirm Action</h4>
                <button class="modal-close" id="close-git-confirm">&times;</button>
            </div>
            <div class="modal-body">
                <div class="confirm-content">
                    <div class="confirm-icon" id="git-confirm-icon">‚ö†Ô∏è</div>
                    <div class="confirm-message" id="git-confirm-message">
                        Are you sure you want to perform this action?
                    </div>
                    <div class="confirm-details" id="git-confirm-details">
                        This action cannot be undone.
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" id="cancel-git-action">Cancel</button>
                <button class="btn btn--danger" id="confirm-git-action">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Processing...</div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toast-container"></div>

    <script src="script.js"></script>
</body>
</html>